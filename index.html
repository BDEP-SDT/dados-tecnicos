<script>
  const GITHUB_API_URL = "https://api.github.com/repos/BDEP-SDT/dados-tecnicos/dispatches";
  const TOKEN = "ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"; // Seu token pessoal com permissão de 'repo'

  document.getElementById("formulario").addEventListener("submit", async (e) => {
    e.preventDefault();

    const dados = {
      nome: document.getElementById("nome").value,
      email: document.getElementById("email").value,
      descricao: document.getElementById("descricao").value,
    };

    try {
      const response = await fetch(GITHUB_API_URL, {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${TOKEN}`,
          "Accept": "application/vnd.github+json",
        },
        body: JSON.stringify({
          event_type: "novo_envio",
          client_payload: dados,
        }),
      });

      if (response.ok) {
        document.getElementById("mensagem").textContent = "✅ Envio registrado!";
      } else {
        const texto = await response.text();
        document.getElementById("mensagem").textContent = "❌ Falha no envio.";
        console.error("Erro:", texto);
      }
    } catch (erro) {
      document.getElementById("mensagem").textContent = "❌ Erro de conexão.";
      console.error(erro);
    }
  });
</script>
